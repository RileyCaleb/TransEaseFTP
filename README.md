# FTP服务器管理工具使用说明
## 一、工具概述
“FTP服务器管理工具(优化版)”是一款基于Python和PyQt5开发的图形化工具，旨在帮助用户轻松管理和配置FTP服务器。它具备丰富的功能，可满足不同用户对FTP服务器的管理需求，支持在Windows系统下运行，为文件传输提供便捷的服务。

## 二、功能介绍
### （一）服务器控制
1. **启动与停止**：在“服务器”标签页，点击“启动”按钮可开启FTP服务器，运行中时按钮文本变为“停止”，点击可停止服务器。也可通过系统托盘菜单的“启动服务器”/“停止服务器”选项操作。
2. **服务器信息展示**：实时显示服务器状态（运行中或已停止）、地址（默认0.0.0.0:端口号）以及根目录路径。
3. **根目录选择**：点击“选择根目录”按钮，可在弹出的文件选择对话框中更改FTP服务器的根目录，选择后服务器根目录会同步更新。

### （二）配置管理
在“配置”标签页，可对FTP服务器的多项参数进行设置：
1. **端口设置**：通过“端口”微调框，在1 - 65535范围内选择服务器监听端口，默认值为21。
2. **最大连接数**：利用“最大连接数”微调框，设置允许同时连接到服务器的最大用户数量，范围是1 - 1000，默认值为50。
3. **超时设置**：在“超时(秒)”微调框中，可设置客户端连接的超时时间，取值范围1 - 3600秒，默认300秒。
4. **编码选择**：从“编码”下拉框里选择服务器使用的编码方式，可选“gb18030”“utf - 8”“latin1”，默认“gb18030”。
5. **日志级别设置**：“日志级别”下拉框提供“DEBUG”“INFO”“WARNING”“ERROR”“CRITICAL”五种级别，用于控制日志记录的详细程度，默认“INFO”。
6. **日志保存设置**：勾选“保存日志到文件”复选框，可将服务器日志保存到本地文件“ftp_server.log”，位于配置文件所在目录。
7. **保存配置**：完成设置后，点击“保存配置”按钮可保存参数。若服务器正在运行，保存后需重启服务器使新配置生效。

### （三）用户管理
当前版本支持匿名用户访问。“用户”标签页预留了未来扩展更多用户管理功能的空间，后续版本将支持添加、删除和管理更多类型用户。

### （四）日志管理
“日志”标签页用于查看服务器日志：
1. **实时显示**：服务器运行过程中的日志信息实时显示在文本框内，方便用户监控服务器活动。
2. **清空日志**：点击“清空日志”按钮，可清除文本框内显示的所有日志记录。

### （五）系统托盘功能
1. **图标显示**：程序运行后，在系统托盘显示图标，图标样式为计算机图标。
2. **托盘菜单操作**：右键点击托盘图标弹出菜单，包含“启动服务器”/“停止服务器”“显示窗口”“隐藏窗口”“退出”等选项，方便用户在后台管理服务器和操作程序窗口。
3. **双击操作**：双击托盘图标可在窗口隐藏时显示窗口，窗口显示时隐藏窗口。

## 三、使用步骤
### （一）启动工具
运行程序后，弹出主窗口，标题为“FTP服务器管理工具(优化版)”，窗口大小为900x700。

### （二）配置服务器
1. 若需修改服务器配置，切换到“配置”标签页，根据需求调整各项参数。
2. 完成设置后点击“保存配置”按钮，若服务器正在运行，保存后会提示重启服务器使更改生效。

### （三）启动服务器
在“服务器”标签页点击“启动”按钮，或通过系统托盘菜单选择“启动服务器”。启动成功后，服务器状态、地址和根目录信息会更新，系统托盘图标提示服务器已启动，日志标签页记录启动信息。若启动失败，会弹出错误对话框显示失败原因。

### （四）使用FTP服务
配置好服务器后，客户端可使用FTP客户端软件（如FileZilla）连接到该服务器。连接时，输入服务器地址（如127.0.0.1:端口号，若使用默认端口21，可省略端口号）、用户名（匿名用户访问时留空或输入“anonymous”）和密码（匿名用户访问时留空）进行连接。

### （五）监控与管理
1. 运行过程中，通过“日志”标签页查看服务器日志，了解服务器运行情况。
2. 若要停止服务器，在“服务器”标签页点击“停止”按钮，或通过系统托盘菜单选择“停止服务器”，停止操作会在日志中记录，系统托盘图标也会提示服务器已停止。

### （六）退出程序
可通过系统托盘菜单的“退出”选项关闭程序。若服务器正在运行，会弹出确认对话框询问是否确定退出，选择“是”停止服务器并退出程序，选择“否”取消退出操作。也可通过关闭主窗口退出程序，操作与托盘菜单退出类似。

## 四、常见问题与解决方法
### （一）启动服务器失败
1. **端口被占用**：更改配置中的端口号，选择未被占用的端口。
2. **根目录不存在或权限不足**：确保根目录存在且程序对其有读写权限，可通过“选择根目录”重新选择正确目录。

### （二）保存配置后设置未生效
保存配置后，若服务器正在运行，需重启服务器使新设置生效。

### （三）无法连接到FTP服务器
1. **检查网络连接**：确保客户端与服务器网络畅通。
2. **确认连接信息**：检查客户端输入的服务器地址、用户名和密码是否正确。
3. **查看服务器日志**：通过“日志”标签页查看服务器日志，获取连接失败的详细信息，排查问题。 
